import{G as W,bw as fe,aK as pe,H as B,aS as ve,I as Y,bW as me,M as $,bX as ye,Q as _,a0 as A,V as h,af as F,W as E,X as e,aF as q,a1 as S,T as f,R as O,ag as H,aO as ge,ah as K,Y as J,_ as Z,bY as be,a3 as G,al as ae,an as Ce,bZ as he,b_ as X,L as w,b$ as _e,a6 as Se,c0 as we,a7 as x,c1 as ke,a9 as Te,ad as le,as as Ee,c2 as De,c3 as ee,F as Fe,aA as $e,az as Pe,J as ne,aa as Be,$ as Ie,U as Ae,c4 as Ne,c5 as Le,by as ze,c6 as Oe,Z as Re,c7 as Me,c8 as Ve,aj as re,bv as Ue,ax as je,ao as oe,c9 as qe,ae as Ke,bp as We,b6 as He,bu as Je,a2 as te,aV as Ze,ca as Qe,bc as se,cb as Ye,b7 as Ge,aE as I,bj as Xe}from"./index-cBNdzZ-c.js";import{u as xe,a as eo}from"./editor-fb8UQ37Q.js";import{u as oo}from"./hooks-ByxKuBvY.js";const ie=Symbol("dialogInjectionKey"),ue=W({center:Boolean,alignCenter:Boolean,closeIcon:{type:fe},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,headerClass:String,bodyClass:String,footerClass:String,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),to={close:()=>!0},so=(...o)=>s=>{o.forEach(a=>{pe(a)?a(s):a.value=s})},ao=B({name:"ElDialogContent"}),lo=B({...ao,props:ue,emits:to,setup(o,{expose:s}){const a=o,{t:k}=ve(),{Close:i}=be,{dialogRef:b,headerRef:v,bodyId:p,ns:n,style:u}=Y(ie),{focusTrapRef:m}=Y(me),y=$(()=>[n.b(),n.is("fullscreen",a.fullscreen),n.is("draggable",a.draggable),n.is("align-center",a.alignCenter),{[n.m("center")]:a.center}]),d=so(m,b),l=$(()=>a.draggable),c=$(()=>a.overflow),{resetPosition:g}=ye(b,v,l,c);return s({resetPosition:g}),(r,T)=>(_(),A("div",{ref:e(d),class:E(e(y)),style:J(e(u)),tabindex:"-1"},[h("header",{ref_key:"headerRef",ref:v,class:E([e(n).e("header"),r.headerClass,{"show-close":r.showClose}])},[F(r.$slots,"header",{},()=>[h("span",{role:"heading","aria-level":r.ariaLevel,class:E(e(n).e("title"))},q(r.title),11,["aria-level"])]),r.showClose?(_(),A("button",{key:0,"aria-label":e(k)("el.dialog.close"),class:E(e(n).e("headerbtn")),type:"button",onClick:D=>r.$emit("close")},[S(e(ge),{class:E(e(n).e("close"))},{default:f(()=>[(_(),O(H(r.closeIcon||e(i))))]),_:1},8,["class"])],10,["aria-label","onClick"])):K("v-if",!0)],2),h("div",{id:e(p),class:E([e(n).e("body"),r.bodyClass])},[F(r.$slots,"default")],10,["id"]),r.$slots.footer?(_(),A("footer",{key:0,class:E([e(n).e("footer"),r.footerClass])},[F(r.$slots,"footer")],2)):K("v-if",!0)],6))}});var no=Z(lo,[["__file","dialog-content.vue"]]);const ro=W({...ue,appendToBody:Boolean,appendTo:{type:G([String,Object]),default:"body"},beforeClose:{type:G(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,headerClass:String,bodyClass:String,footerClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"}}),io={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[ae]:o=>Ce(o),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},uo=(o,s)=>{var a;const i=Ee().emit,{nextZIndex:b}=he();let v="";const p=X(),n=X(),u=w(!1),m=w(!1),y=w(!1),d=w((a=o.zIndex)!=null?a:b());let l,c;const g=_e("namespace",De),r=$(()=>{const C={},P=`--${g.value}-dialog`;return o.fullscreen||(o.top&&(C[`${P}-margin-top`]=o.top),o.width&&(C[`${P}-width`]=Se(o.width))),C}),T=$(()=>o.alignCenter?{display:"flex"}:{});function D(){i("opened")}function U(){i("closed"),i(ae,!1),o.destroyOnClose&&(y.value=!1)}function j(){i("close")}function R(){c==null||c(),l==null||l(),o.openDelay&&o.openDelay>0?{stop:l}=ee(()=>M(),o.openDelay):M()}function N(){l==null||l(),c==null||c(),o.closeDelay&&o.closeDelay>0?{stop:c}=ee(()=>V(),o.closeDelay):V()}function L(){function C(P){P||(m.value=!0,u.value=!1)}o.beforeClose?o.beforeClose(C):N()}function z(){o.closeOnClickModal&&L()}function M(){Fe&&(u.value=!0)}function V(){u.value=!1}function t(){i("openAutoFocus")}function Q(){i("closeAutoFocus")}function de(C){var P;((P=C.detail)==null?void 0:P.focusReason)==="pointer"&&C.preventDefault()}o.lockScroll&&we(u);function ce(){o.closeOnPressEscape&&L()}return x(()=>o.modelValue,C=>{C?(m.value=!1,R(),y.value=!0,d.value=ke(o.zIndex)?b():d.value++,Te(()=>{i("open"),s.value&&(s.value.parentElement.scrollTop=0,s.value.parentElement.scrollLeft=0,s.value.scrollTop=0)})):u.value&&N()}),x(()=>o.fullscreen,C=>{s.value&&(C?(v=s.value.style.transform,s.value.style.transform=""):s.value.style.transform=v)}),le(()=>{o.modelValue&&(u.value=!0,y.value=!0,R())}),{afterEnter:D,afterLeave:U,beforeLeave:j,handleClose:L,onModalClick:z,close:N,doClose:V,onOpenAutoFocus:t,onCloseAutoFocus:Q,onCloseRequested:ce,onFocusoutPrevented:de,titleId:p,bodyId:n,closed:m,style:r,overlayDialogStyle:T,rendered:y,visible:u,zIndex:d}},co=B({name:"ElDialog",inheritAttrs:!1}),fo=B({...co,props:ro,emits:io,setup(o,{expose:s}){const a=o,k=$e();Pe({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},$(()=>!!k.title));const i=ne("dialog"),b=w(),v=w(),p=w(),{visible:n,titleId:u,bodyId:m,style:y,overlayDialogStyle:d,rendered:l,zIndex:c,afterEnter:g,afterLeave:r,beforeLeave:T,handleClose:D,onModalClick:U,onOpenAutoFocus:j,onCloseAutoFocus:R,onCloseRequested:N,onFocusoutPrevented:L}=uo(a,b);Be(ie,{dialogRef:b,headerRef:v,bodyId:m,ns:i,rendered:l,style:y});const z=Ve(U),M=$(()=>a.draggable&&!a.fullscreen);return s({visible:n,dialogContentRef:p,resetPosition:()=>{var t;(t=p.value)==null||t.resetPosition()}}),(t,Q)=>(_(),O(e(Me),{to:t.appendTo,disabled:t.appendTo!=="body"?!1:!t.appendToBody},{default:f(()=>[S(Ie,{name:"dialog-fade",onAfterEnter:e(g),onAfterLeave:e(r),onBeforeLeave:e(T),persisted:""},{default:f(()=>[Ae(S(e(Ne),{"custom-mask-event":"",mask:t.modal,"overlay-class":t.modalClass,"z-index":e(c)},{default:f(()=>[h("div",{role:"dialog","aria-modal":"true","aria-label":t.title||void 0,"aria-labelledby":t.title?void 0:e(u),"aria-describedby":e(m),class:E(`${e(i).namespace.value}-overlay-dialog`),style:J(e(d)),onClick:e(z).onClick,onMousedown:e(z).onMousedown,onMouseup:e(z).onMouseup},[S(e(Le),{loop:"",trapped:e(n),"focus-start-el":"container",onFocusAfterTrapped:e(j),onFocusAfterReleased:e(R),onFocusoutPrevented:e(L),onReleaseRequested:e(N)},{default:f(()=>[e(l)?(_(),O(no,ze({key:0,ref_key:"dialogContentRef",ref:p},t.$attrs,{center:t.center,"align-center":t.alignCenter,"close-icon":t.closeIcon,draggable:e(M),overflow:t.overflow,fullscreen:t.fullscreen,"header-class":t.headerClass,"body-class":t.bodyClass,"footer-class":t.footerClass,"show-close":t.showClose,title:t.title,"aria-level":t.headerAriaLevel,onClose:e(D)}),Oe({header:f(()=>[t.$slots.title?F(t.$slots,"title",{key:1}):F(t.$slots,"header",{key:0,close:e(D),titleId:e(u),titleClass:e(i).e("title")})]),default:f(()=>[F(t.$slots,"default")]),_:2},[t.$slots.footer?{name:"footer",fn:f(()=>[F(t.$slots,"footer")])}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","header-class","body-class","footer-class","show-close","title","aria-level","onClose"])):K("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,["aria-label","aria-labelledby","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["mask","overlay-class","z-index"]),[[Re,e(n)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var po=Z(fo,[["__file","dialog.vue"]]);const vo=re(po),mo=W({type:{type:String,values:["primary","success","info","warning","danger",""],default:""},size:{type:String,values:Ue,default:""},truncated:Boolean,lineClamp:{type:[String,Number]},tag:{type:String,default:"span"}}),yo=B({name:"ElText"}),go=B({...yo,props:mo,setup(o){const s=o,a=w(),k=je(),i=ne("text"),b=$(()=>[i.b(),i.m(s.type),i.m(k.value),i.is("truncated",s.truncated),i.is("line-clamp",!oe(s.lineClamp))]),v=qe().title,p=()=>{var n,u,m,y,d;if(v)return;let l=!1;const c=((n=a.value)==null?void 0:n.textContent)||"";if(s.truncated){const g=(u=a.value)==null?void 0:u.offsetWidth,r=(m=a.value)==null?void 0:m.scrollWidth;g&&r&&r>g&&(l=!0)}else if(!oe(s.lineClamp)){const g=(y=a.value)==null?void 0:y.offsetHeight,r=(d=a.value)==null?void 0:d.scrollHeight;g&&r&&r>g&&(l=!0)}l?a.value.setAttribute("title",c):a.value.removeAttribute("title")};return le(p),Ke(p),(n,u)=>(_(),O(H(n.tag),{ref_key:"textRef",ref:a,class:E(e(b)),style:J({"-webkit-line-clamp":n.lineClamp})},{default:f(()=>[F(n.$slots,"default")]),_:3},8,["class","style"]))}});var bo=Z(go,[["__file","text.vue"]]);const Co=re(bo),ho={class:"preview-container pb-40"},_o={class:"center mc"},So={class:"button-group flex space-between align-items-center"},wo={class:"flex space-between no-print"},ko={class:"mr-15"},To={class:"content-group no-border"},Eo=["href"],Do={class:"dialog-footer"},Fo=B({__name:"Preview",setup(o){const s=xe(),a=We(),k=He(),i=Number(a.params.id),b=oo(s.coms).value,v=w(!1),p=w("");function n(){switch(a.params.from){case"home":k.push("/");break;case"edit":k.push("/editor");break}}function u(){if(!s.coms.every(l=>Qe(l.name))){se.error("存在不适合做 PDF 的组件，请检查后重试");return}window.print()}function m(){const d=Ye();fetch("/api/saveQuiz",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:d,quizData:{coms:JSON.stringify(s.coms),surveyCount:s.surveyCount}})}).then(()=>{p.value=`${window.location.origin}/quiz/${d}`,v.value=!0})}function y(){navigator.clipboard.writeText(p.value).then(()=>{v.value=!1,se.success("复制成功")})}return i&&eo(i).then(d=>{Je(d.coms),s.setStore(d)}),(d,l)=>{const c=Ge,g=Co,r=vo;return _(),A(te,null,[h("div",ho,[h("div",_o,[h("div",So,[h("div",wo,[S(c,{type:"danger",onClick:n},{default:f(()=>l[1]||(l[1]=[I("返回")])),_:1}),S(c,{type:"success",onClick:m},{default:f(()=>l[2]||(l[2]=[I("生成在线问卷")])),_:1}),S(c,{type:"warning",onClick:u},{default:f(()=>l[3]||(l[3]=[I("生成本地PDF")])),_:1})]),h("div",ko,[S(g,{class:"mx-1"},{default:f(()=>[I("题目数量："+q(e(s).surveyCount),1)]),_:1})])]),h("div",To,[(_(!0),A(te,null,Ze(e(s).coms,(T,D)=>(_(),A("div",{class:"content mb-10",key:D},[(_(),O(H(T.type),{status:T.status,serialNum:e(b)[D]},null,8,["status","serialNum"]))]))),128))])])]),S(r,{modelValue:v.value,"onUpdate:modelValue":l[0]||(l[0]=T=>v.value=T),title:"信息",width:"500"},{footer:f(()=>[h("div",Do,[S(c,{type:"primary",onClick:y},{default:f(()=>l[4]||(l[4]=[I("复制链接")])),_:1})])]),default:f(()=>[l[5]||(l[5]=I(" 分享链接: ")),h("a",{href:p.value,target:"_blank"},q(p.value),9,Eo)]),_:1},8,["modelValue"])],64)}}}),Io=Xe(Fo,[["__scopeId","data-v-db862a7d"]]);export{Io as default};
